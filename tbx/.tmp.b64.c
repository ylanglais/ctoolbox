Ci8qCiAqIEJhc2U2NCBlbmNvZGluZy9kZWNvZGluZyAoUkZDMTM0MSkKICogQ29weXJpZ2h0IChj
KSAyMDA1LTIwMTEsIEpvdW5pIE1hbGluZW4gPGpAdzEuZmk+CiAqCiAqIFRoaXMgc29mdHdhcmUg
bWF5IGJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgQlNEIGxpY2Vuc2UuCiAq
IFNlZSBSRUFETUUgZm9yIG1vcmUgZGV0YWlscy4KICovCgojaW5jbHVkZSA8c3RkbGliLmg+CiNp
bmNsdWRlIDxzdHJpbmcuaD4KCiNpbmNsdWRlICJiNjQuaCIKCmNoYXIgYjY0X01PRFVMRVtdICA9
ICJiYXNlIDY0IHtlbixkZX1jb2RpbmcgZnJvbSBKb3VuaSBNYWxpbmVuIjsKY2hhciBiNjRfUFVS
UE9TRVtdID0gImJhc2UgNjQge2VuLGRlfWNvZGluZyBmcm9tIEpvdW5pIE1hbGluZW4iOwpjaGFy
IGI2NF9WRVJTSU9OW10gPSAiMS4wLjAiOwpjaGFyIGI2NF9EQVRFVkVSW10gPSAiMDkvMTAvMjAx
NyI7CgoKc3RhdGljIGNvbnN0IHVuc2lnbmVkIGNoYXIgYjY0X3RhYmxlWzY1XSA9ICJBQkNERUZH
SElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsv
IjsKCi8qKgogKiBiNjRfZW5jb2RlIC0gQmFzZTY0IGVuY29kZQogKiBAc3JjOiBEYXRhIHRvIGJl
IGVuY29kZWQKICogQGxlbjogTGVuZ3RoIG9mIHRoZSBkYXRhIHRvIGJlIGVuY29kZWQKICogQG91
dF9sZW46IFBvaW50ZXIgdG8gb3V0cHV0IGxlbmd0aCB2YXJpYWJsZSwgb3IgJU5VTEwgaWYgbm90
IHVzZWQKICogUmV0dXJuczogQWxsb2NhdGVkIGJ1ZmZlciBvZiBvdXRfbGVuIGJ5dGVzIG9mIGVu
Y29kZWQgZGF0YSwKICogb3IgJU5VTEwgb24gZmFpbHVyZQogKgogKiBDYWxsZXIgaXMgcmVzcG9u
c2libGUgZm9yIGZyZWVpbmcgdGhlIHJldHVybmVkIGJ1ZmZlci4gUmV0dXJuZWQgYnVmZmVyIGlz
CiAqIG51bCB0ZXJtaW5hdGVkIHRvIG1ha2UgaXQgZWFzaWVyIHRvIHVzZSBhcyBhIEMgc3RyaW5n
LiBUaGUgbnVsIHRlcm1pbmF0b3IgaXMKICogbm90IGluY2x1ZGVkIGluIG91dF9sZW4uCiAqLwoj
ZGVmaW5lIExXIDc0CnVuc2lnbmVkIGNoYXIgKgpiNjRfZW5jb2RlKGNvbnN0IHVuc2lnbmVkIGNo
YXIgKnNyYywgc2l6ZV90IGxlbiwgc2l6ZV90ICpvdXRfbGVuKSB7CiAgICB1bnNpZ25lZCBjaGFy
ICpvdXQsICpwb3M7CiAgICBjb25zdCB1bnNpZ25lZCBjaGFyICplbmQsICppbjsKICAgIHNpemVf
dCBvbGVuOwogICAgaW50IGxpbmVfbGVuOwoKICAgIG9sZW4gPSBsZW4gKiA0IC8gMyArIDQ7ICAg
ICAvKiAzLWJ5dGUgYmxvY2tzIHRvIDQtYnl0ZSAqLwogICAgb2xlbiArPSBvbGVuIC8gTFc7ICAg
ICAgICAgIC8qIGxpbmUgZmVlZHMgKi8KICAgIG9sZW4rKzsgICAgICAgICAgICAgICAgICAgICAv
KiBudWwgdGVybWluYXRpb24gKi8KICAgIGlmIChvbGVuIDwgbGVuKQogICAgICAgIHJldHVybiBO
VUxMOyAgICAgICAgICAgIC8qIGludGVnZXIgb3ZlcmZsb3cgKi8KICAgIG91dCA9IG1hbGxvYyhv
bGVuKTsKICAgIGlmIChvdXQgPT0gTlVMTCkKICAgICAgICByZXR1cm4gTlVMTDsKCiAgICBlbmQg
PSBzcmMgKyBsZW47CiAgICBpbiA9IHNyYzsKICAgIHBvcyA9IG91dDsKICAgIGxpbmVfbGVuID0g
MDsKICAgIHdoaWxlIChlbmQgLSBpbiA+PSAzKSB7CiAgICAgICAgKnBvcysrID0gYjY0X3RhYmxl
W2luWzBdID4+IDJdOwogICAgICAgICpwb3MrKyA9IGI2NF90YWJsZVsoKGluWzBdICYgMHgwMykg
PDwgNCkgfCAoaW5bMV0gPj4gNCldOwogICAgICAgICpwb3MrKyA9IGI2NF90YWJsZVsoKGluWzFd
ICYgMHgwZikgPDwgMikgfCAoaW5bMl0gPj4gNildOwogICAgICAgICpwb3MrKyA9IGI2NF90YWJs
ZVtpblsyXSAgICYgMHgzZl07CiAgICAgICAgaW4gKz0gMzsKICAgICAgICBsaW5lX2xlbiArPSA0
OwogICAgICAgIGlmIChsaW5lX2xlbiA+PSBMVykgewogICAgICAgICAgICAqcG9zKysgPSAnXG4n
OwogICAgICAgICAgICBsaW5lX2xlbiA9IDA7CiAgICAgICAgfQogICAgfQoKICAgIGlmIChlbmQg
LSBpbikgewogICAgICAgICpwb3MrKyA9IGI2NF90YWJsZVtpblswXSA+PiAyXTsKICAgICAgICBp
ZiAoZW5kIC0gaW4gPT0gMSkgewogICAgICAgICAgICAqcG9zKysgPSBiNjRfdGFibGVbKGluWzBd
ICYgMHgwMykgPDwgNF07CiAgICAgICAgICAgICpwb3MrKyA9ICc9JzsKICAgICAgICB9IGVsc2Ug
ewogICAgICAgICAgICAqcG9zKysgPSBiNjRfdGFibGVbKChpblswXSAmIDB4MDMpIDw8IDQpIHwg
KGluWzFdID4+IDQpXTsKICAgICAgICAgICAgKnBvcysrID0gYjY0X3RhYmxlWyhpblsxXSAmIDB4
MGYpIDw8IDJdOwogICAgICAgIH0KICAgICAgICAqcG9zKysgPSAnPSc7CiAgICAgICAgbGluZV9s
ZW4gKz0gNDsKICAgIH0KCiAgICBpZiAobGluZV9sZW4pCiAgICAgICAgKnBvcysrID0gJ1xuJzsK
CiAgICAqcG9zID0gJ1wwJzsKICAgIGlmIChvdXRfbGVuKQogICAgICAgICpvdXRfbGVuID0gcG9z
IC0gb3V0OwogICAgcmV0dXJuIG91dDsKfQoKLyoqCiAqIGI2NF9kZWNvZGUgLSBCYXNlNjQgZGVj
b2RlCiAqIEBzcmM6IERhdGEgdG8gYmUgZGVjb2RlZAogKiBAbGVuOiBMZW5ndGggb2YgdGhlIGRh
dGEgdG8gYmUgZGVjb2RlZAogKiBAb3V0X2xlbjogUG9pbnRlciB0byBvdXRwdXQgbGVuZ3RoIHZh
cmlhYmxlCiAqIFJldHVybnM6IEFsbG9jYXRlZCBidWZmZXIgb2Ygb3V0X2xlbiBieXRlcyBvZiBk
ZWNvZGVkIGRhdGEsCiAqIG9yICVOVUxMIG9uIGZhaWx1cmUKICoKICogQ2FsbGVyIGlzIHJlc3Bv
bnNpYmxlIGZvciBmcmVlaW5nIHRoZSByZXR1cm5lZCBidWZmZXIuCiAqLwp1bnNpZ25lZCBjaGFy
ICoKYjY0X2RlY29kZShjb25zdCB1bnNpZ25lZCBjaGFyICpzcmMsIHNpemVfdCBsZW4sIHNpemVf
dCAqIG91dF9sZW4pIHsKICAgIHVuc2lnbmVkIGNoYXIgZHRhYmxlWzI1Nl0sICpvdXQsICpwb3Ms
IGJsb2NrWzRdLCB0bXA7CiAgICBzaXplX3QgaSwgY291bnQsIG9sZW47CiAgICBpbnQgcGFkID0g
MDsKCiAgICBtZW1zZXQoZHRhYmxlLCAweDgwLCAyNTYpOwogICAgZm9yIChpID0gMDsgaSA8IHNp
emVvZihiNjRfdGFibGUpIC0gMTsgaSsrKQogICAgICAgIGR0YWJsZVtiNjRfdGFibGVbaV1dID0g
KHVuc2lnbmVkIGNoYXIpaTsKICAgIGR0YWJsZVsnPSddID0gMDsKCiAgICBjb3VudCA9IDA7CiAg
ICBmb3IgKGkgPSAwOyBpIDwgbGVuOyBpKyspIHsKICAgICAgICBpZiAoZHRhYmxlW3NyY1tpXV0g
IT0gMHg4MCkKICAgICAgICAgICAgY291bnQrKzsKICAgIH0KCiAgICBpZiAoY291bnQgPT0gMCB8
fCBjb3VudCAlIDQpCiAgICAgICAgcmV0dXJuIE5VTEw7CgogICAgb2xlbiA9IGNvdW50IC8gNCAq
IDM7CiAgICBwb3MgPSBvdXQgPSBtYWxsb2Mob2xlbiArIDEpOwogICAgaWYgKG91dCA9PSBOVUxM
KQogICAgICAgIHJldHVybiBOVUxMOwoKICAgIGNvdW50ID0gMDsKICAgIGZvciAoaSA9IDA7IGkg
PCBsZW47IGkrKykgewogICAgICAgIHRtcCA9IGR0YWJsZVtzcmNbaV1dOwogICAgICAgIGlmICh0
bXAgPT0gMHg4MCkKICAgICAgICAgICAgY29udGludWU7CgogICAgICAgIGlmIChzcmNbaV0gPT0g
Jz0nKQogICAgICAgICAgICBwYWQrKzsKICAgICAgICBibG9ja1tjb3VudF0gPSB0bXA7CiAgICAg
ICAgY291bnQrKzsKICAgICAgICBpZiAoY291bnQgPT0gNCkgewogICAgICAgICAgICAqcG9zKysg
PSAoYmxvY2tbMF0gPDwgMikgfCAoYmxvY2tbMV0gPj4gNCk7CiAgICAgICAgICAgICpwb3MrKyA9
IChibG9ja1sxXSA8PCA0KSB8IChibG9ja1syXSA+PiAyKTsKICAgICAgICAgICAgKnBvcysrID0g
KGJsb2NrWzJdIDw8IDYpIHwgYmxvY2tbM107CiAgICAgICAgICAgIGNvdW50ID0gMDsKICAgICAg
ICAgICAgaWYgKHBhZCkgewogICAgICAgICAgICAgICAgaWYgKHBhZCA9PSAxKQogICAgICAgICAg
ICAgICAgICAgIHBvcy0tOwogICAgICAgICAgICAgICAgZWxzZSBpZiAocGFkID09IDIpCiAgICAg
ICAgICAgICAgICAgICAgcG9zIC09IDI7CiAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAg
ICAgICAgICAgICAvKiBJbnZhbGlkIHBhZGRpbmcgKi8KICAgICAgICAgICAgICAgICAgICBmcmVl
KG91dCk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE5VTEw7CiAgICAgICAgICAgICAgICB9
CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAg
ICAqb3V0X2xlbiA9IHBvcyAtIG91dDsKICAgIHJldHVybiBvdXQ7Cn0KCiNpZmRlZiBfdGVzdF9i
NjRfCgojaW5jbHVkZSA8c3RkaW8uaD4KI2luY2x1ZGUgPHVuaXN0ZC5oPgojaW5jbHVkZSA8c3lz
L3R5cGVzLmg+CiNpbmNsdWRlIDxzeXMvc3RhdC5oPgojaW5jbHVkZSA8ZmNudGwuaD4KI2luY2x1
ZGUgPGVycm5vLmg+CiNpbmNsdWRlICJlcnIuaCIKI2luY2x1ZGUgImZ1dGwuaCIKCmludCBtYWlu
KHZvaWQpIHsKCXNpemVfdCBsZW47CgljaGFyICpzdHJvOwoJY2hhciAqc3RyYjY0c3lzOwoJY2hh
ciAqc3RyYjY0dGJ4OwoJY2hhciAqc3RyZjsKCWNoYXIgbmFtZVsxMDBdOwoJY2hhciBjbWRbMTAw
XTsKCgllcnJfbGV2ZWxfc2V0KGVycl9ERUJVRyk7CgoJLyogUmVhZCBzb3VyY2UgZmlsZTogKi8K
CWlmICghKHN0cm8gPSBmdXRsX2xvYWQoX19GSUxFX18sIE5VTEwpKSkgcmV0dXJuIDE7CgkKCXNw
cmludGYobmFtZSwgIi50bXAuJXMiLCBfX0ZJTEVfXyk7CglzcHJpbnRmKGNtZCwgImJhc2U2NCAl
cyA+ICVzIiwgX19GSUxFX18sIG5hbWUpOwoJc3lzdGVtKGNtZCk7CgoJaWYgKCEoc3RyYjY0c3lz
ID0gZnV0bF9sb2FkKG5hbWUsIE5VTEwpKSkgewoJCWZyZWUoc3Rybyk7CgkJcmV0dXJuIDI7Cgl9
CglzdHJiNjR0YnggPSAoY2hhciAqKSBiNjRfZW5jb2RlKCh1bnNpZ25lZCBjaGFyICopIHN0cm8s
IHN0cmxlbihzdHJvKSwgJmxlbik7CgkKCWlmIChzdHJjbXAoc3RyYjY0c3lzLCBzdHJiNjR0Yngp
KSB7CgkJZXJyX2Vycm9yKCJlbmNvZGVyIGRpdmVyZ2VzOiAiKTsKCQllcnJfZXJyb3IoIlxuJXMi
LCBzdHJiNjR0YngpOwoJfSBlbHNlIHsKCQllcnJfZGVidWcoImVuY29kZXIgc2VlbXMgZmluZSIp
OwoJfQoJCQoJc3RyZiA9IChjaGFyICopIGI2NF9kZWNvZGUoKHVuc2lnbmVkIGNoYXIgKikgc3Ry
YjY0c3lzLCBzdHJsZW4oc3RyYjY0c3lzKSwgJmxlbik7CglpZiAoc3RyY21wKHN0cm8sIHN0cmYp
KSB7CgkJZXJyX2Vycm9yKCJkZWNvZGVyIGRpdmVyZ2VzIik7Cgl9IGVsc2UgewoJCWVycl9kZWJ1
ZygiZGVjb2RlciBzZWVtcyBmaW5lIik7Cgl9CgkKCWZyZWUoc3Rybyk7IGZyZWUoc3RyZik7Cglm
cmVlKHN0cmI2NHN5cyk7IGZyZWUoc3RyYjY0dGJ4KTsKCglyZXR1cm4gMDsKfQojZW5kaWYKCg==
